<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start" (click)="closeModal()"><ion-icon name="arrow-back-outline" slot="icon-only"></ion-icon></ion-buttons>
    <ion-title class="ion-no-padding ion-text-capitalize">{{gridSelctionTitle}}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="pages ion-padding-horizontal">
  
  <ion-card class="contactdetails app-grid_selection fixed_button detail_grid" *ngIf="cardType == 'demo1'">
    <div class="" *ngFor="let column of columnList; let i = index" [ngClass]="column.display ? 'd-block':'d-none'">
      <div *ngIf="!column.editable" class="enquerylist ">
        <span [title]="column.label" class="detail-grid">{{column.label}}<ion-text>&nbsp;:&nbsp;</ion-text></span>
        <strong [innerHtml]="getValueForGrid(column,data)"></strong>
      </div>
      <div *ngIf="column.editable" class="enquerylist">
        <span [title]="column.label" class="detail-grid">{{column.label}} <ion-text color="danger" *ngIf="column.is_mandatory">*</ion-text><ion-text>&nbsp;:&nbsp;</ion-text></span>        
        <span *ngIf="column.type.toLowerCase() == 'text'" class="editable-input-wrapper">
            <input  type="text" class="form-control form-control-sm d-inline mr-2" (keyup)="calculateNetAmount(data,column, i)" [(ngModel)]="data[column.field_name]" [disabled]="isDisable(column,data)" [readonly]="readonly" [id]="column._id+'_'+column.field_name">
        </span>
        <span *ngIf="column.type.toLowerCase() == 'textarea'" class="editable-input-wrapper">
          <input type="text" class="form-control form-control-sm d-inline mr-2" [(ngModel)]="data[column.field_name]" [disabled]="isDisable(column,data)" [readonly]="readonly" [id]="column._id+'_'+column.field_name">
        </span>
        <span *ngIf="column.type.toLowerCase() == 'number'" class="editable-input-wrapper">
          <input  type="number" class="form-control form-control-sm d-inline mr-2" (keyup)="calculateNetAmount(data,column, i)"  [(ngModel)]="data[column.field_name]" [disabled]="isDisable(column,data)" [readonly]="readonly" [id]="column._id+'_'+column.field_name">
        </span>
        <span *ngIf="column.type.toLowerCase() == 'boolean'" class="editable-input-wrapper" >
            <ion-checkbox [(ngModel)]="data[column.field_name]" [ngclass]="column.field_class" class="ion-margin-end" [disabled]="isDisable(column,data)" [disabled]="readonly" [id]="column._id+'_'+column.field_name"></ion-checkbox>            
        </span>        
        <span *ngIf="column.type.toLowerCase() == 'dropdown'" class="editable-input-wrapper">
            <ion-select [interfaceOptions]="customAlertOptions" interface="{{ionSelectInterface}}" [selectedText]="data[column.field_name]" [(ngModel)]="data[column.field_name]" [disabled]="isDisable(column,data)" [readonly]="readonly" class="ion-border_bottom ion-padding-end" (ionCancel)="clearDropdownField($event, column)" cancel-text="Clear" (ionDismiss)="$event.stopPropagation()" (ionFocus)="selectionFocus(column)" [id]="column._id+'_'+column.field_name">
              <ion-select-option *ngFor="let staticValue of staticData[column.ddn_field]" [value]="staticValue">{{ staticValue.name ? staticValue.name : staticValue }}</ion-select-option>
            </ion-select>
        </span>        
        <span *ngIf="column.type.toLowerCase() == 'userinput_chips'" class="editable-input-wrapper userInputChips">         
          <ion-chip  *ngFor="let item of data[column.field_name]; let i = index" [disabled]="isDisable(column,data)" [disabled]="readonly">
            <ion-label>{{ item.name ? item.name : item }}</ion-label>
            <ion-icon name="close-outline" (click)="removeItem(data,column,i)"></ion-icon>
          </ion-chip>
          <ng-select [bindLabel]="'column.name'" [addTag]="true" #chipsInput [(ngModel)]="userInputChipsData" notFoundText="No records found" (keyup)="searchTypeaheadData(column,data,$event)" (change)="setValue($event,column,data,i,chipsInput,'change')" (keyup.enter)="setValue($event,column,data,i,chipsInput,'keyupenter')" (close)="resetVariables()" [disabled]="isDisable(column,data)" [readonly]="readonly" enterkeyhint="done" [id]="column._id+'_'+column.field_name">
            <ng-option *ngFor="let option of typeAheadData" [value]="option">{{ option.name ? option.name : option }}</ng-option>
          </ng-select>
        </span>
        <span *ngIf="column.type.toLowerCase() == 'chips'" class="editable-input-wrapper chips">         
          <ion-chip  *ngFor="let item of data[column.field_name]; let i = index" [disabled]="isDisable(column,data)" [disabled]="readonly">
            <ion-label>{{item.name ? item.name : item}}</ion-label>
            <ion-icon name="close-outline" (click)="removeItem(data,column,i)"></ion-icon>
          </ion-chip>
          <ng-select [bindLabel]="'column.name'" #typeheadchips [(ngModel)]="chipsData" notFoundText="No records found" (keyup)="searchTypeaheadData(column,data,$event)" (change)="setValue($event,column,data,i,typeheadchips)" (close)="resetVariables()" [disabled]="isDisable(column,data)" [readonly]="readonly" enterkeyhint="enter" [id]="column._id+'_'+column.field_name">
            <ng-option *ngFor="let option of typeAheadData" [value]="option">{{ option.name ? option.name : option }}</ng-option>
          </ng-select>          
        </span>

        <div *ngIf="column.type == 'file'" class="camera_file_upload">
          <ion-accordion-group expand="inset" class="ion-margin-horizontal-0 ion-margin-vertical-0" [value]="column._id+'_'+column.field_name">
            <ion-accordion value="{{column._id+'_'+column.field_name}}">
              <ion-item slot="header" color="light" line="inset">
                <ion-label>{{ column.label | titlecase}} <ion-text *ngIf="column.is_mandatory" class="ng-star-inserted"> *</ion-text></ion-label>
                <ion-button expand="round" slot="end" size="small" fill="outline" *ngIf="dataListForUpload[column.field_name] && dataListForUpload[column.field_name].length > 0" >{{ dataListForUpload[column.field_name].length > 0 ? dataListForUpload[column.field_name].length : '' }}</ion-button>
                <ion-button expand="round" slot="end" size="small" fill="outline" [id]="column._id+'_'+column.field_name" (click)="selectImageSource('',column)" [formControlName]="column.field_name" [disabled]="column.is_disabled">
                  <ion-icon slot="icon-only" name="cloud-upload-outline"></ion-icon>
                </ion-button>
                
              </ion-item>
              <div class="ion-padding" slot="content" class="ion-padding-top">
                <ion-item lines="none" class="ion-margin-bottom" *ngIf="!dataListForUpload[column.field_name] || (dataListForUpload[column.field_name] && dataListForUpload[column.field_name].length == 0)">
                  <ion-label>No file uploaded, <ion-text>please upload</ion-text> <ion-text slot="error" class="text-danger">field is <strong>required</strong></ion-text></ion-label>
                </ion-item>
                <ion-list class="contactlist ion-margin-start ion-margin-end" *ngIf="dataListForUpload[column.field_name] && dataListForUpload[column.field_name].length > 0">
                  <ion-item class="ion-margin-bottom" *ngFor="let file of dataListForUpload[column.field_name]; let i = index;">
                  
                    <ion-label *ngIf="(file.rollName && file.rollName != null) || (file.fileName && file.fileName != null)">{{file.fileName || file.rollName}}</ion-label>
                    <ion-label *ngIf="(!file.rollName && file.rollName == null)">{{file._id}}</ion-label>
                    <ion-button slot="end" class="" fill="clear" (click)="removeAttachedDataFromList(i,column.field_name)">
                      <ion-icon slot="icon-only" name="trash-outline" color=""></ion-icon>
                    </ion-button>
                    <ion-button slot="end" class="" fill="clear" *ngIf="file && file._id" (click)="imageDownload(file)">
                      <ion-icon slot="icon-only" name="download" color=""></ion-icon>
                    </ion-button>
                  </ion-item>
                </ion-list> 
              </div>
            </ion-accordion>
          </ion-accordion-group>
        </div>


      </div>
    </div>
    <ion-card-content *ngIf="columnList.length == 0">
      <ion-text>Grid Columns are not available In This Field.</ion-text>
      <ion-button type="button" color="appcolor" outline="true" size="small" expand="block" (click)="closeModal()">Go Back</ion-button>
    </ion-card-content>
  </ion-card>
</ion-content>
<ion-footer> 
  <div  class="inlineFormGridSelectionButton">
      <ion-row class="">
        <ion-col>
          <ion-button *ngIf="(gridselectionverticalbutton && grid_row_selection) || (!gridselectionverticalbutton)" type="button" color="appcolor" [disabled]="readonly"  (click)="select()" size="small" expand="block" >{{formInfo.updateMode == true ? 'Update' : 'Add'}}</ion-button>
          <ion-button *ngIf="(gridselectionverticalbutton && !grid_row_selection)" type="button" [disabled]="" color="appcolor" outline="true" size="small" expand="block"  (click)="selectGridData()" >{{ fieldButtonLabel(field)}}</ion-button >
        </ion-col>
        <ion-col>
          <ion-button *ngIf="(gridselectionverticalbutton && grid_row_selection)" type="button" color="appcolor" [disabled]="readonly" (click)="remove()" size="small" expand="block" >Remove</ion-button>
          <ion-button *ngIf="(gridselectionverticalbutton && !grid_row_selection) || (!gridselectionverticalbutton)" type="button" color="appcolor" [disabled]="" (click)="closeModal()" size="small" expand="block" >Cancel</ion-button>
        </ion-col>
      </ion-row>
      <!-- <div *ngIf="!grid_row_selection">
        <ion-button  type="button" [disabled]="checkValidator()" color="appcolor" outline="true" size="small" expand="block"  (click)="selectGridData()">{{ fieldButtonLabel(field)}}</ion-button >
        <ion-button type="button" color="appcolor" outline="true" size="small" expand="block" (click)="closeModal()">Close</ion-button>
      </div> -->
  </div>
</ion-footer>